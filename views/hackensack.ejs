<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/normalize.css"/>
    <link rel="stylesheet" href="../css/style.css"/>
    <title>HST Tracker</title>
</head>
<body>
    <!-- Username -->
    <header>
        <div>
            <span><i class="fa-solid fa-bell"></i></span>
            <span>User</span>
        </div>
    </header>
    <!-- Title -->
    <section class="title">
        <h1>Home Sleep Study Tracker</h1>
        <h3>For the office of Samuel H.S. The</h3>
        <div>
            <span class="active-lab">Hackensack</span>
            <span>|</span>
            <a href="/studies/wayne">Wayne</a>
        </div>
    </section>

    <section class="main-body">
        <!-- Search form -->
        <section class="search-bar">
            <label for="patient-search">Patient search:</label>
            <input type="search" id="patient-search">
            <button>Search</button>
        </section>

        <!-- Patient list -->
        <section class="table-container">
            <section id="hackensack" class="tab-content">
                <table>
                    <thead>
                        <tr>
                            <th colspan="10"><h3>Hackensack</h3></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="category-row">
                            <td></td>
                            <td>Patient Last Name</td>
                            <td>Patient First Name</td>
                            <td>Date of Study</td>
                            <td class="study-amount">Num. of Studies</td>
                            <td>Assigned to:</td>
                            <td class="study-comment">Comments</td>
                            <td>Completed by Tech</td>
                            <td>Completed by M.D.</td>
                            <td></td>
                        </tr>
                        <% for (let i = 0; i < hackensack.length; i++) {%>
                            <tr> <% if (hackensack[i].lab === 'hackensack') {%>
                                <td><%= i + 1 %></td>
                                <td class="last-name"><%= hackensack[i].patientLastName %></td>
                                <td class="first-name"><%= hackensack[i].patientFirstName %></td>
                                <td class="study-date"><%= hackensack[i].studyDate %></td>
                                <td><%= hackensack[i].studyAmount %></td>
                                <td><%= hackensack[i].techName %></td>
                                <td><%= hackensack[i].comment %></td>
                                <td><%= hackensack[i].techCompleted %></td>
                                <td><%= hackensack[i].doctorCompleted %></td>
                                <td class="edit-icons" data-id="<%= hackensack[i]._id %>"><i class="fa-solid fa-pen-to-square"></i><i class="fa-solid fa-trash-can"></i></td>
                            </tr> <% } %>
                        <% } %>
                    </tbody>
                </table>
            </section>
        </section>
        <!-- Add study form -->
        <button class="add-patient" onclick="openForm()">Add</button>
        <section class="form-popup" id="patient-form">
            <form action="/studies/addStudy" method="POST" class="form-container">
                <h2 class="form-header">Add study</h2>

                <div class="form-fields">
                    <div class="lab-select">
                        <label for="lab">Sleep lab:</label>
                        <select name="lab" id="lab">
                            <option value="select">Select lab</option>
                            <option value="hackensack">Hackensack</option>
                            <option value="wayne">Wayne</option>
                        </select>
                    </div>
                    <div class="field">
                        <label for="patientLastName">Last name:</label>
                        <input type="text" name="patientLastName">
                    </div>
                    <div class="field">
                        <label for="patientFirstName">First name:</label>
                        <input type="text" name="patientFirstName">
                    </div>
                    <div class="field">
                        <label for="studyDate">Date of study:</label>
                        <input type="date" name="studyDate">
                    </div>
                    <div class="field">
                        <label for="studyAmount">No. of studies:</label>
                        <input type="text" name="studyAmount">
                    </div>
                    <div class="field">
                        <label for="techName">Assign to:</label>
                        <input type="text" name="techName">
                    </div>
                </div>

                <div class="form-buttons">
                    <button type="submit" class="btn">Add</button>
                    <button type="button" class="btn cancel" onclick="closeForm()">Cancel</button>
                </div>
            </form>
        </section>

    </section>

    <script src="https://kit.fontawesome.com/c92b06f6cd.js" crossorigin="anonymous"></script>
    <script type="text/javascript" src="../js/main.js"></script>
</body>
</html>